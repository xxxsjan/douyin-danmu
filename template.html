<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <button onclick="changebtn()">add</button>

  <div id="list">

    <div class="webcast-chatroom___bottom-message" style="background-color: transparent;">
      <div class="webcast-chatroom___item fade fade-enter-done" data-id="7398518088011916322"
        elementtiming="element-timing" style="background-color: transparent;">
        <div class="TNg5meqw" elementtiming="element-timing"><span elementtiming="element-timing"
            style="cursor: pointer; display: inline-block; height: 20px; vertical-align: middle;"><span class="k3s5qMFF"
              elementtiming="element-timing"><span class="e7Bc18Wu" elementtiming="element-timing"><img alt=""
                  src="https://p11-webcast.douyinpic.com/img/webcast/new_user_grade_level_v1_1.png~tplv-obj.image"
                  height="18" elementtiming="element-timing"></span></span></span><span class="u2QdU6ht"
            elementtiming="element-timing">CR400BF-Z：</span><span class="WsJsvMP9"
            elementtiming="element-timing">为主播点赞了</span></div>
      </div>
    </div>
  </div>

  <script>
    const msgContainerElClass = '.webcast-chatroom___items'
    const roomClass = ".webcast-chatroom___items > div:first-child";
    // 新进直播间
    const bottomMsgClass = ".webcast-chatroom___bottom-message .webcast-chatroom___item";

    const btmMsgEl = document.querySelector(bottomMsgClass);

    const chatroom = document.querySelector(roomClass);

    // 新进观众dom 监听
    // btmMsgEl.addEventListener(
    //   "DOMSubtreeModified",
    //   function (e) {
    //     console.log('DOMSubtreeModified: ', e);
    //     if (e.target.nodeType === 3) {
    //       console.log(e.target.nodeValue);
    //       // socket &&
    //       //   socket.send(
    //       //     JSON.stringify({
    //       //       type: "来了",
    //       //       data: e.target.nodeValue,
    //       //     })
    //       //   );
    //     }
    //   },
    //   false
    // );
    const observer = new MutationObserver(function (mutations) {
      mutations.forEach(function (mutation) {
        console.log('mutation: ', mutation);

      });
    });
    observer.observe(btmMsgEl, {
      attributes: true,
      // attributefilter: ["class", 'style'],
      // childList: true,
      // subtree: true,
    });

    function changebtn() {
      btmMsgEl.style.backgroundColor = "red";
    }

    function createItem() {
      const element = document.createElement("div");
      element.classList.add("webcast-chatroom___bottom-message");
      element.style.backgroundColor = "transparent";

      const innerElement = document.createElement("div");
      innerElement.classList.add("webcast-chatroom___item", "fade", "fade-enter-done");
      innerElement.setAttribute("data-id", "7398518088011916322");
      innerElement.setAttribute("elementtiming", "element-timing");
      innerElement.style.backgroundColor = "transparent";

      const span1 = document.createElement("span");
      span1.classList.add("TNg5meqw");
      span1.setAttribute("elementtiming", "element-timing");
      span1.style.cursor = "pointer";
      span1.style.display = "inline-block";
      span1.style.height = "20px";
      span1.style.verticalAlign = "middle";

      const span2 = document.createElement("span");
      span2.classList.add("k3s5qMFF");
      span2.setAttribute("elementtiming", "element-timing");

      const span3 = document.createElement("span");
      span3.classList.add("e7Bc18Wu");
      span3.setAttribute("elementtiming", "element-timing");

      const img = document.createElement("img");
      img.setAttribute("alt", "");
      img.setAttribute("src", "https://p11-webcast.douyinpic.com/img/webcast/new_user_grade_level_v1_1.png~tplv-obj.image");
      img.setAttribute("height", "18");
      img.setAttribute("elementtiming", "element-timing");

      span3.appendChild(img);
      span2.appendChild(span3);
      span1.appendChild(span2);

      const span4 = document.createElement("span");
      span4.classList.add("u2QdU6ht");
      span4.setAttribute("elementtiming", "element-timing");
      span4.textContent = Date.now() + "：";

      const span5 = document.createElement("span");
      span5.classList.add("WsJsvMP9");
      span5.setAttribute("elementtiming", "element-timing");
      span5.textContent = "为主播点赞了";

      innerElement.appendChild(span1);
      innerElement.appendChild(span4);
      innerElement.appendChild(span5);
      element.appendChild(innerElement);

      list.appendChild(element);

    }
  </script>
</body>

</html>